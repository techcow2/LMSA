/* Performance optimizations for the app */

/* Apply hardware acceleration to key elements */
.hardware-accelerated,
#messages,
#chat-history,
#sidebar,
.character-gallery-container,
.monaco-container,
.modal-content,
.welcome-container,
.character-card {
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
    will-change: transform, opacity;
}

/* Optimize animations */
.animate-fade-in {
    animation-duration: 0.25s;
    animation-timing-function: cubic-bezier(0.2, 0, 0.2, 1);
}

/* Optimize transitions */
.transition-optimized,
.character-card,
.character-gallery-container,
.modal-content,
#scroll-to-bottom,
.menu-item,
.chat-item {
    transition-timing-function: cubic-bezier(0.2, 0, 0.2, 1) !important;
}

/* Optimize scrolling */
.scroll-optimized,
#chat-history,
#sidebar,
.character-gallery-content,
.settings-content-wrapper,
.modal-content {
    -webkit-overflow-scrolling: touch !important;
    touch-action: pan-y !important;
    overscroll-behavior: contain !important;
    scroll-behavior: auto !important; /* Use JS for smooth scrolling instead */
}

/* Special handling for messages container to allow smooth scrolling */
#messages {
    -webkit-overflow-scrolling: touch !important;
    touch-action: pan-y !important;
    overscroll-behavior: contain !important;
    /* Allow smooth scrolling for this container */
}

/* Optimize touch targets for mobile */
@media (max-width: 768px) {
    .button,
    .menu-item,
    .chat-item,
    .character-card-btn,
    #send-btn,
    #stop-btn,
    #scroll-to-bottom {
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 10px !important;
    }

    /* Increase tap target size without affecting layout */
    .menu-item::after,
    .chat-item::after,
    .button::after {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        z-index: -1;
    }
}

/* Optimize image loading */
img[data-src] {
    opacity: 0;
    transition: opacity 0.3s ease-in;
}

img[data-src][src]:not([src^="data:"]) {
    opacity: 1;
}

/* Placeholder for images while loading */
.img-placeholder {
    background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
    background-size: 200% 100%;
    animation: shimmer 1.5s linear infinite;
}

@keyframes shimmer {
    0% { background-position: 100% 0; }
    100% { background-position: -100% 0; }
}

/* Optimize Monaco editor containers */
.monaco-container {
    contain: content; /* Use CSS containment for better performance */
}

/* Optimize scroll-to-bottom button */
#scroll-to-bottom {
    transition: opacity 0.2s cubic-bezier(0.2, 0, 0.2, 1),
                transform 0.2s cubic-bezier(0.2, 0, 0.2, 1),
                visibility 0.2s cubic-bezier(0.2, 0, 0.2, 1) !important;
}

/* Optimize modals */
.modal-content {
    contain: content; /* Use CSS containment for better performance */
}

/* Optimize welcome message */
.welcome-container {
    contain: layout; /* Use CSS containment for better performance */
}

/* Optimize character cards */
.character-card {
    contain: content; /* Use CSS containment for better performance */
}

/* Optimize for reduced motion if user prefers it */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.001ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.001ms !important;
        scroll-behavior: auto !important;
    }
}

/* Optimize for mobile devices */
@media (max-width: 768px) {
    /* Reduce animation complexity on mobile */
    .animate-fade-in {
        animation-duration: 0.2s;
    }

    /* Optimize touch scrolling on mobile */
    body, html {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }

    /* Ensure buttons have proper touch feedback */
    button, .button, .menu-item, .chat-item {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    }
}
